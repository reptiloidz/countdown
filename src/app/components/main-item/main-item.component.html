<div
	*appLet="point | checkAccessEdit as hasAccessEdit"
	class="point color"
	[ngClass]="[
		hasAccessEdit ? 'point--available' : '',
		point.color ? 'color--' + point.color : '',
		isCard ? 'point--card' : ''
	]"
>
	<a
		routerLink="/point/{{ point.id }}"
		[attr.title]="point.description || null"
		class="point__main"
	>
		<h2 class="point__title">
			<span
				app-tooltip
				(mouseenter)="loadUserInfo(point.user)"
			>
				<span>{{ point.title }}</span>
				<ng-container *ngIf="point?.userInfo">
					<ng-container *ngIf="point.userInfo?.displayName || point.userInfo?.photoURL else userEmpty;">
						<ng-template #tooltipContent>
							<img
								*ngIf="point.userInfo?.photoURL"
								class="userpic userpic--sm"
								[src]="point.userInfo?.photoURL"
								[alt]="point.userInfo?.displayName"
							>{{ point.userInfo?.displayName }}
						</ng-template>
					</ng-container>
					<ng-template #userEmpty>
						<ng-template #tooltipContent>...</ng-template>
					</ng-template>
				</ng-container>
			</span>
		</h2>
		<p
			*ngIf="point.description"
			class="point__description"
		>{{ point.description }}</p>
	</a>

	<div
		class="point__nav"
		*ngIf="loading || hasAccessEdit"
	>
		<ng-container *ngIf="!loading && hasAccessEdit; else loader">
			<button
				app-button
				mode="negative"
				icon="cross"
				title="Удалить событие"
				(click)="delete(point.id)"
			></button>
			<ng-container
				*ngIf="checkboxTemplate else defaultCheckbox;"
				[ngTemplateOutlet]="checkboxTemplate"
			></ng-container>
			<ng-template #defaultCheckbox>
				<label
					#pointCheckbox
					app-checkbox
					(change)="checkPoint()"
				></label>
			</ng-template>
		</ng-container>
	</div>
	<div class="point__markers">
		<div
			class="marker"
			[ngClass]="{
				'marker--inactive': !point.greenwich
			}"
			[title]="point.greenwich ? 'По Гринвичу' : 'По местному времени'"
		>
			<svg
				app-svg
				name="globe"
				aria-hidden="false"
				class="marker__inner"
			></svg>
		</div>
		<div
			class="marker"
			[ngClass]="{
				'marker--inactive': !point.repeatable
			}"
			[title]="point.repeatable ? 'Повторяемое' : 'Однократное'"
		>
			<svg
				app-svg
				name="refresh"
				aria-hidden="false"
				class="marker__inner"
			></svg>
		</div>
		<div
			class="marker"
			[ngClass]="{
				'marker--inactive': !point.public
			}"
			[title]="point.public ? 'Публичное' : 'Приватное'"
		>
			<svg
				app-svg
				name="users"
				aria-hidden="false"
				class="marker__inner"
			></svg>
		</div>
	</div>

	<ng-template #loader>
		<span
			*ngIf="loading"
			class="loader rotating"
		></span>
	</ng-template>

</div>
