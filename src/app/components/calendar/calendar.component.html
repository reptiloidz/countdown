<div class="calendar__nav">
	<div class="calendar__aside">
		<button
			app-button
			icon="chevron-left"
			mode="ghost"
			(click)="switchCalendarPeriod(false)"
		></button>
		<button
			app-button
			icon="chevron-right"
			mode="ghost"
			(click)="switchCalendarPeriod(true)"
		></button>
		<button
			app-button
			icon="clock"
			mode="positive"
			(click)="switchCalendarToNow()"
		></button>
		<button
			app-button
			icon="home-2"
			(click)="switchCalendarToSelected()"
		></button>
	</div>

	<div
		class="calendar__status"
		*ngIf="!hideCurrentPeriod"
	>{{ visiblePeriod }}</div>

	<div
		class="calendar__aside"
		*ngIf="!hideModeSwitch"
	>
		<app-switcher
			[items]="calendarModes"
			[value]="activeMode"
			(valueSwitched)="switchCalendarMode($event)"
		></app-switcher>
	</div>
</div>

<table>
	<thead *ngIf="activeMode === 'month'">
		<tr>
			<th>пн</th>
			<th>вт</th>
			<th>ср</th>
			<th>чт</th>
			<th>пт</th>
			<th>сб</th>
			<th>вс</th>
		</tr>
	</thead>
	<tbody>
		<tr *ngFor="let period of calendarArray">
			<td
				class="calendar__cell"
				*ngFor="let item of period"
			>
				<button
					class="calendar__button link"
					type="button"
					[ngClass]="{
						'calendar__button--selected': item.selectedDate,
						'calendar__button--now': item.nowDate,
					}"
					(click)="dateClicked({
						date: item.date,
						activeMode,
						points: item.points,
						iterations: item.iterations
					})"
				>
					<ng-container *ngIf="item.points.length || item.iterations.length">
						<span
							*ngIf="point?.repeatable || item.points.length else mark;"
							class="calendar__counter"
						>{{ item.points.length || item.iterations.length }}</span>
						<ng-template #mark>
							<span class="calendar__counter">&#10003;</span>
						</ng-template>
					</ng-container>
					{{ getItemDate(item.date) }}
				</button>
				<div class="calendar__date-nav">
					<ng-container
						*ngIf="navTemplate"
						[ngTemplateOutlet]="navTemplate"
						[ngTemplateOutletContext]="{ date: item, mode: this.activeMode, point: this.point }"
					></ng-container>
				</div>
			</td>
		</tr>
	</tbody>
</table>
